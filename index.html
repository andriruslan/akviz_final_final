<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ê–∫–í—ñ–∑_–ö–ê–ì–ê–†–õ–ò–ö</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; background: #f2f2f2; }
    h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
    .version { font-size: 0.9rem; color: #555; margin-bottom: 1rem; }
    .group { margin-bottom: 1rem; }
    label { display: block; margin-bottom: 0.3rem; }
    input[type=text], input[type=number] {
      width: 100%; padding: 0.5rem; font-size: 1rem;
    }
    input[readonly] { background-color: #eaeaea; }
    button {
      padding: 0.4rem 1rem;
      font-size: 1rem;
      margin-top: 0.5rem;
      margin-right: 0.5rem;
    }
    .lock-button {
      background: none; border: none; font-size: 1.3rem; cursor: pointer;
    }
    .inline-buttons { display: flex; gap: 0.5rem; align-items: center; }
    .radio-group { display: flex; flex-direction: column; gap: 0.3rem; }
    #debug { font-family: monospace; font-size: 0.9rem; color: #666; }
  </style>
</head>
<body>
  <h1>–ê–∫–í—ñ–∑_–ö–ê–ì–ê–†–õ–ò–ö</h1>
  <div class="version">–í–µ—Ä—Å—ñ—è 1.1.3</div>

  <div class="group"><label>–ü—ñ–¥–ø–æ—Ä—è–¥–∫—É–≤–∞–Ω–Ω—è (*)</label><div class="inline-buttons"><input id="sector" type="text" readonly><button class="lock-button" onclick="toggleLock('sector')">üîí</button></div></div>
  <div class="group"><label>–ü–æ–∑–∏—Ü—ñ—è (*)</label><div class="inline-buttons"><input id="position" type="text" readonly><button class="lock-button" onclick="toggleLock('position')">üîí</button></div></div>
  <div class="group"><label>–ù–∞—Å–µ–ª–µ–Ω–∏–π –ø—É–Ω–∫—Ç (*)</label><div class="inline-buttons"><input id="location" type="text" readonly><button class="lock-button" onclick="toggleLock('location')">üîí</button></div></div>
    <div class="group">
    <label>–¢–∏–ø —Ü—ñ–ª—ñ</label>
    <div class="radio-group">
      <label><input type="radio" name="target" value="–ë–ü–õ–ê –ª—ñ—Ç–∞–∫–æ–≤–æ–≥–æ —Ç–∏–ø—É"> –ë–ü–õ–ê –ª—ñ—Ç–∞–∫–æ–≤–æ–≥–æ —Ç–∏–ø—É</label>
      <label><input type="radio" name="target" value="–ü–æ—Å—Ç—Ä—ñ–ª–∏ (–ó–£, –∫—É–ª–µ–º–µ—Ç)"> –ü–æ—Å—Ç—Ä—ñ–ª–∏ (–ó–£, –∫—É–ª–µ–º–µ—Ç)</label>
      <label><input type="radio" name="target" value="–í–∏—Ö–æ–¥–∏ (–ü–ó–†–ö, –ó–†–ö)"> –í–∏—Ö–æ–¥–∏ (–ü–ó–†–ö, –ó–†–ö)</label>
      <label><input type="radio" name="target" value="–í–∏–±—É—Ö –ö–†"> –í–∏–±—É—Ö –ö–†</label>
      <label><input type="radio" name="target" value="–ì–µ–ª—ñ–∫–æ–ø—Ç–µ—Ä"> –ì–µ–ª—ñ–∫–æ–ø—Ç–µ—Ä</label>
      <label><input type="radio" name="target" value="–õ—ñ—Ç–∞–∫ (–º–∞–ª–∏–π)"> –õ—ñ—Ç–∞–∫ (–º–∞–ª–∏–π)</label>
      <label><input type="radio" name="target" value="–õ—ñ—Ç–∞–∫ (–≤–µ–ª–∏–∫–∏–π)"> –õ—ñ—Ç–∞–∫ (–≤–µ–ª–∏–∫–∏–π)</label>
      <label><input type="radio" name="target" value="–ó–æ–Ω–¥"> –ó–æ–Ω–¥</label>
      <label><input type="radio" name="target" value="–ù–µ–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–µ"> –ù–µ–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–µ</label>
      <label><input type="radio" name="target" value="–Ü–Ω—à–µ"> –Ü–Ω—à–µ</label>
      <label><input type="radio" name="target" value="–ê–µ—Ä–æ—Å—Ç–∞—Ç"> –ê–µ—Ä–æ—Å—Ç–∞—Ç</label>
    </div>
  </div>

  <div class="group">
    <label>–°—Ç–æ—Ä–æ–Ω–∞</label>
    <div class="radio-group">
      <label><input type="radio" name="side" value="–í–æ—Ä–æ–∂–∏–π"> –í–æ—Ä–æ–∂–∏–π</label>
      <label><input type="radio" name="side" value="–°–≤—ñ–π"> –°–≤—ñ–π</label>
      <label><input type="radio" name="side" value="–ù–µ–π—Ç—Ä–∞–ª—å–Ω–∏–π"> –ù–µ–π—Ç—Ä–∞–ª—å–Ω–∏–π</label>
    </div>
  </div>

  <div class="group">
    <label><input type="checkbox" id="noNumber" checked onchange="toggleNumberField()"> –ë–µ–∑ –≤–∏–¥–∞—á—ñ</label>
    <input type="number" id="targetNumber" placeholder="–Ω–æ–º–µ—Ä —Ü—ñ–ª—ñ" readonly>
  </div>

  <div class="group">
    <label>–ù–∞–∑–≤–∞</label>
    <input type="text" id="targetName" placeholder="–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Shahed-136">
    <div class="inline-buttons">
      <button onclick="document.getElementById('targetName').value='Shahed-136'">Shahed-136</button>
      <button onclick="document.getElementById('
  <div class="group">
    <label>–ê–∑–∏–º—É—Ç, ¬∞ (*)</label>
    <input type="number" id="azimuth" placeholder="–í–≤–µ–¥—ñ—Ç—å –∞–±–æ –≤–∏–∑–Ω–∞—á—Ç–µ">
    <button id="azimuthBtn" onclick="toggleSensor('azimuth')">–≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∞–∑–∏–º—É—Ç</button>
  </div>

  <div class="group">
    <label>–ö—É—Ä—Å, ¬∞ (*)</label>
    <input type="number" id="course" placeholder="–í–≤–µ–¥—ñ—Ç—å –∞–±–æ –≤–∏–∑–Ω–∞—á—Ç–µ">
    <button id="courseBtn" onclick="toggleSensor('course')">–≤–∏–∑–Ω–∞—á–∏—Ç–∏ –ö—É—Ä—Å</button>
  </div>

  <div class="group">
    <label>üß™ –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–º–ø–∞—Å–∞</label>
    <div id="debug">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö...</div>
  </div>

  <script>
    function toggleLock(id) {
      const input = document.getElementById(id);
      input.readOnly = !input.readOnly;
      if (input.readOnly) localStorage.setItem(id, input.value);
      else input.focus();
    }

    function changeCount(delta) {
      const field = document.getElementById('targetCount');
      let val = parseInt(field.value) + delta;
      if (val <= 1) {
        val = 1;
        document.getElementById('minusBtn').disabled = true;
      } else {
        document.getElementById('minusBtn').disabled = false;
      }
      field.value = val;
    }

    function toggleNumberField() {
      const field = document.getElementById('targetNumber');
      const noNumber = document.getElementById('noNumber').checked;
      field.readOnly = noNumber;
      if (noNumber) field.value = '';
    }

    function loadStored() {
      ['sector', 'position', 'location'].forEach(id => {
        const v = localStorage.getItem(id);
        if (v) document.getElementById(id).value = v;
      });
    }

    let sensors = {
      azimuth: { active: false, heading: 0, handler: null },
      course: { active: false, heading: 0, handler: null }
    };

    function toggleSensor(type) {
      const field = document.getElementById(type);
      const btn = document.getElementById(type + 'Btn');

      if (!sensors[type].active) {
        window.addEventListener("deviceorientation", sensors[type].handler = function(event) {
          let heading = null;
          const dbg = document.getElementById("debug");
          let alpha = event.alpha != null ? event.alpha.toFixed(2) : "null";
          let absolute = event.absolute != null ? event.absolute : "–Ω/–¥";
          let wch = event.webkitCompassHeading !== undefined ? event.webkitCompassHeading.toFixed(2) : "–Ω/–¥";

          if (event.webkitCompassHeading !== undefined) {
            heading = Math.round(event.webkitCompassHeading);
          } else if (event.absolute === true && event.alpha != null) {
            heading = Math.round(360 - event.alpha);
          } else if (event.alpha != null) {
            heading = Math.round(360 - event.alpha);
            dbg.innerHTML = `‚ö†Ô∏è fallback (alpha=${alpha}) ‚Üí ${heading}¬∞ | absolute=${absolute} | wch=${wch}`;
          }

          if (heading != null) {
            sensors[type].heading = heading % 360;
            field.value = sensors[type].heading;
          }
        }, true);
        btn.textContent = "–∑–±–µ—Ä–µ–≥—Ç–∏";
        sensors[type].active = true;
      } else {
        window.removeEventListener("deviceorientation", sensors[type].handler, true);
        field.value = sensors[type].heading;
        btn.textContent = type === "azimuth" ? "–≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∞–∑–∏–º—É—Ç" : "–≤–∏–∑–Ω–∞—á–∏—Ç–∏ –ö—É—Ä—Å";
        sensors[type].active = false;
      }
    }

    window.onload = () => {
      loadStored();
      toggleNumberField();
    };
  </script>
</body>
</html>

